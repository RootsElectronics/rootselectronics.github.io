<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Klang Research SSS1 - Financial Model</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 16px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        .header {
            background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        .header h1 { font-size: 2.5em; margin-bottom: 10px; }
        .header p { opacity: 0.9; font-size: 1.1em; }
        .download-section {
            padding: 40px;
            text-align: center;
            background: #f8fafc;
            border-bottom: 2px solid #e2e8f0;
        }
        .btn-download {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            border: none;
            padding: 18px 50px;
            font-size: 1.3em;
            font-weight: bold;
            border-radius: 12px;
            cursor: pointer;
            box-shadow: 0 10px 30px rgba(16, 185, 129, 0.3);
            transition: all 0.3s;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        .btn-download:hover {
            transform: translateY(-2px);
            box-shadow: 0 15px 40px rgba(16, 185, 129, 0.4);
        }
        .content {
            padding: 40px;
        }
        .section {
            margin-bottom: 40px;
        }
        .section h2 {
            color: #1e3a8a;
            font-size: 1.8em;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #3b82f6;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        th {
            background: #1e3a8a;
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 600;
        }
        td {
            padding: 12px 15px;
            border-bottom: 1px solid #e2e8f0;
        }
        tr:hover { background: #f8fafc; }
        .highlight { background: #fef3c7; font-weight: bold; }
        .profit-positive { color: #059669; font-weight: bold; }
        .profit-negative { color: #dc2626; font-weight: bold; }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        .stat-card {
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            padding: 20px;
            border-radius: 12px;
            border-left: 4px solid #3b82f6;
        }
        .stat-label {
            font-size: 0.9em;
            color: #64748b;
            margin-bottom: 8px;
        }
        .stat-value {
            font-size: 2em;
            font-weight: bold;
            color: #1e3a8a;
        }
        .warning {
            background: #fef3c7;
            border-left: 4px solid #f59e0b;
            padding: 15px;
            margin: 20px 0;
            border-radius: 8px;
        }
        .success {
            background: #d1fae5;
            border-left: 4px solid #10b981;
            padding: 15px;
            margin: 20px 0;
            border-radius: 8px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üéöÔ∏è Klang Research SSS1</h1>
            <p>Complete Financial Operating Model</p>
        </div>

        <div class="download-section">
            <button class="btn-download" onclick="downloadExcel()">
                ‚¨áÔ∏è Download Full Excel Spreadsheet
            </button>
            <p style="margin-top: 20px; color: #64748b;">
                Includes all calculations, formulas, and projections ready to edit
            </p>
        </div>

        <div class="content">
            <div class="section">
                <h2>üìä Unit Economics</h2>
                <table id="unitEconomics">
                    <tr>
                        <th>Item</th>
                        <th style="text-align: right;">Value</th>
                    </tr>
                    <tr>
                        <td>Material Cost per Unit</td>
                        <td style="text-align: right;">¬£23.12</td>
                    </tr>
                    <tr>
                        <td>Labour Cost per Unit (¬£25/hr √ó 1.6 hrs)</td>
                        <td style="text-align: right;">¬£40.00</td>
                    </tr>
                    <tr class="highlight">
                        <td><strong>TRUE UNIT COST</strong></td>
                        <td style="text-align: right;"><strong>¬£63.12</strong></td>
                    </tr>
                    <tr>
                        <td>Retail Price</td>
                        <td style="text-align: right;">¬£129.00</td>
                    </tr>
                    <tr>
                        <td>Wholesale Price (25% margin to shop)</td>
                        <td style="text-align: right;">¬£96.75</td>
                    </tr>
                    <tr>
                        <td>Distributor Price (40% margin)</td>
                        <td style="text-align: right;">¬£77.40</td>
                    </tr>
                    <tr class="highlight">
                        <td><strong>PROFIT per Unit (DTC)</strong></td>
                        <td style="text-align: right;" class="profit-positive"><strong>¬£65.88</strong></td>
                    </tr>
                    <tr class="highlight">
                        <td><strong>PROFIT per Unit (Wholesale)</strong></td>
                        <td style="text-align: right;" class="profit-positive"><strong>¬£33.63</strong></td>
                    </tr>
                    <tr class="highlight">
                        <td><strong>PROFIT per Unit (Distributor)</strong></td>
                        <td style="text-align: right;" class="profit-negative"><strong>¬£14.28</strong></td>
                    </tr>
                </table>
            </div>

            <div class="section">
                <h2>üè≠ Batch Economics (15 Units)</h2>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-label">Units Built</div>
                        <div class="stat-value">15</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Saleable Units</div>
                        <div class="stat-value">14</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Material Cost</div>
                        <div class="stat-value">¬£347</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Labour Cost</div>
                        <div class="stat-value">¬£600</div>
                    </div>
                    <div class="stat-card" style="grid-column: span 2; background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);">
                        <div class="stat-label">Total Batch Cost</div>
                        <div class="stat-value">¬£947</div>
                    </div>
                    <div class="stat-card" style="grid-column: span 2; background: linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%);">
                        <div class="stat-label">Revenue (All DTC)</div>
                        <div class="stat-value" style="color: #059669;">¬£1,806</div>
                    </div>
                </div>
            </div>

            <div class="section">
                <h2>üìà 6-Month Sales Forecast</h2>
                <table id="forecast">
                    <tr>
                        <th>Month</th>
                        <th style="text-align: right;">DTC Units</th>
                        <th style="text-align: right;">Wholesale</th>
                        <th style="text-align: right;">Total Units</th>
                        <th style="text-align: right;">Revenue</th>
                        <th style="text-align: right;">COGS</th>
                        <th style="text-align: right;">Profit</th>
                        <th style="text-align: right;">Cumulative</th>
                    </tr>
                    <tr>
                        <td>Month 1</td>
                        <td style="text-align: right;">0</td>
                        <td style="text-align: right;">0</td>
                        <td style="text-align: right;">0</td>
                        <td style="text-align: right;">¬£0</td>
                        <td style="text-align: right;">¬£0</td>
                        <td style="text-align: right;">¬£0</td>
                        <td style="text-align: right;">¬£0</td>
                    </tr>
                    <tr>
                        <td>Month 2 (Launch)</td>
                        <td style="text-align: right;">8</td>
                        <td style="text-align: right;">3</td>
                        <td style="text-align: right;">11</td>
                        <td style="text-align: right;">¬£1,322</td>
                        <td style="text-align: right;">¬£694</td>
                        <td style="text-align: right;" class="profit-positive">¬£628</td>
                        <td style="text-align: right;">¬£628</td>
                    </tr>
                    <tr>
                        <td>Month 3</td>
                        <td style="text-align: right;">15</td>
                        <td style="text-align: right;">5</td>
                        <td style="text-align: right;">20</td>
                        <td style="text-align: right;">¬£2,419</td>
                        <td style="text-align: right;">¬£1,262</td>
                        <td style="text-align: right;" class="profit-positive">¬£1,157</td>
                        <td style="text-align: right;">¬£1,785</td>
                    </tr>
                    <tr>
                        <td>Month 4</td>
                        <td style="text-align: right;">18</td>
                        <td style="text-align: right;">7</td>
                        <td style="text-align: right;">25</td>
                        <td style="text-align: right;">¬£2,999</td>
                        <td style="text-align: right;">¬£1,578</td>
                        <td style="text-align: right;" class="profit-positive">¬£1,421</td>
                        <td style="text-align: right;">¬£3,206</td>
                    </tr>
                    <tr>
                        <td>Month 5</td>
                        <td style="text-align: right;">20</td>
                        <td style="text-align: right;">5</td>
                        <td style="text-align: right;">25</td>
                        <td style="text-align: right;">¬£3,064</td>
                        <td style="text-align: right;">¬£1,578</td>
                        <td style="text-align: right;" class="profit-positive">¬£1,486</td>
                        <td style="text-align: right;">¬£4,692</td>
                    </tr>
                    <tr>
                        <td>Month 6</td>
                        <td style="text-align: right;">22</td>
                        <td style="text-align: right;">3</td>
                        <td style="text-align: right;">25</td>
                        <td style="text-align: right;">¬£3,129</td>
                        <td style="text-align: right;">¬£1,578</td>
                        <td style="text-align: right;" class="profit-positive">¬£1,551</td>
                        <td style="text-align: right;">¬£6,243</td>
                    </tr>
                    <tr class="highlight">
                        <td><strong>TOTAL</strong></td>
                        <td style="text-align: right;"><strong>83</strong></td>
                        <td style="text-align: right;"><strong>23</strong></td>
                        <td style="text-align: right;"><strong>106</strong></td>
                        <td style="text-align: right;"><strong>¬£12,933</strong></td>
                        <td style="text-align: right;"><strong>¬£6,690</strong></td>
                        <td style="text-align: right;" class="profit-positive"><strong>¬£6,243</strong></td>
                        <td style="text-align: right;"></td>
                    </tr>
                </table>
            </div>

            <div class="section">
                <h2>üí° Key Insights</h2>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-label">Total Units (6 months)</div>
                        <div class="stat-value">106</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Avg Profit/Unit</div>
                        <div class="stat-value" style="color: #059669;">¬£58.90</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Gross Margin</div>
                        <div class="stat-value" style="color: #059669;">48.3%</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Batches Needed</div>
                        <div class="stat-value">8</div>
                    </div>
                </div>

                <div class="success">
                    <strong>‚úÖ This business model works:</strong> Even with full labour costs included, you're hitting healthy margins on both DTC and wholesale channels.
                </div>

                <div class="warning">
                    <strong>‚ö†Ô∏è Strategic Note:</strong> Distributor channel shows ¬£14.28 profit per unit ‚Äî avoid unless you're doing 200+ units/batch and manufacturing costs drop significantly.
                </div>
            </div>

            <div class="section">
                <h2>üéØ What's in the Excel File</h2>
                <ul style="line-height: 2; margin-left: 20px;">
                    <li><strong>Sheet 1: Assumptions</strong> ‚Äî Edit any value, everything recalculates</li>
                    <li><strong>Sheet 2: Unit Economics</strong> ‚Äî Costs, prices, margins by channel</li>
                    <li><strong>Sheet 3: Batch Economics</strong> ‚Äî Per-batch costs and revenue</li>
                    <li><strong>Sheet 4: 6-Month Forecast</strong> ‚Äî Monthly projections with totals</li>
                    <li><strong>Sheet 5: VAT Scenarios</strong> ‚Äî Impact when you register for VAT</li>
                    <li><strong>Sheet 6: Simple Ledger</strong> ‚Äî Track actual cash in/out</li>
                </ul>
            </div>
        </div>
    </div>

    <script>
        function downloadExcel() {
            // Create workbook
            const wb = XLSX.utils.book_new();

            // Sheet 1: Assumptions
            const assumptions = [
                ['KLANG RESEARCH SSS1 - FINANCIAL MODEL'],
                [''],
                ['ASSUMPTIONS - EDIT THESE VALUES'],
                [''],
                ['PRICING'],
                ['Retail Price', 129],
                ['Wholesale Margin (%)', 25],
                ['Wholesale Price', 96.75],
                ['Distributor Margin (%)', 40],
                ['Distributor Price', 77.4],
                [''],
                ['COSTS'],
                ['Material Cost per Unit', 23.12],
                ['Labour Rate (¬£/hour)', 25],
                ['Hours per Batch', 24],
                ['Units per Batch', 15],
                ['Labour per Unit', 40],
                [''],
                ['TRUE UNIT COST', 63.12],
                [''],
                ['OTHER'],
                ['Promo Units per Batch', 1],
                ['Saleable Units per Batch', 14],
                ['VAT Rate (%)', 20],
                ['VAT Registered?', 'No']
            ];
            const ws1 = XLSX.utils.aoa_to_sheet(assumptions);
            XLSX.utils.book_append_sheet(wb, ws1, 'Assumptions');

            // Sheet 2: Unit Economics
            const unitEcon = [
                ['UNIT ECONOMICS'],
                [''],
                ['Item', 'Value'],
                ['Material Cost', 23.12],
                ['Labour Cost', 40],
                ['TRUE UNIT COST', 63.12],
                [''],
                ['Retail Price', 129],
                ['Wholesale Price', 96.75],
                ['Distributor Price', 77.4],
                [''],
                ['PROFIT PER UNIT'],
                ['DTC Profit', 65.88],
                ['Wholesale Profit', 33.63],
                ['Distributor Profit', 14.28]
            ];
            const ws2 = XLSX.utils.aoa_to_sheet(unitEcon);
            XLSX.utils.book_append_sheet(wb, ws2, 'Unit Economics');

            // Sheet 3: Batch Economics
            const batchEcon = [
                ['BATCH ECONOMICS (15 UNITS)'],
                [''],
                ['Item', 'Value'],
                ['Units Built', 15],
                ['Promo Units', 1],
                ['Saleable Units', 14],
                [''],
                ['Material Cost (¬£23.12 √ó 15)', 346.8],
                ['Labour Cost (24 hrs √ó ¬£25)', 600],
                ['Total Batch Cost', 946.8],
                [''],
                ['Revenue if All DTC (14 √ó ¬£129)', 1806],
                ['Revenue if All Wholesale (14 √ó ¬£96.75)', 1354.5],
                [''],
                ['Profit if All DTC', 859.2],
                ['Profit if All Wholesale', 407.7]
            ];
            const ws3 = XLSX.utils.aoa_to_sheet(batchEcon);
            XLSX.utils.book_append_sheet(wb, ws3, 'Batch Economics');

            // Sheet 4: 6-Month Forecast
            const forecast = [
                ['6-MONTH SALES FORECAST'],
                [''],
                ['Month', 'DTC Units', 'Wholesale Units', 'Total Units', 'Revenue', 'COGS', 'Profit', 'Cumulative'],
                ['Month 1', 0, 0, 0, 0, 0, 0, 0],
                ['Month 2 (Launch)', 8, 3, 11, 1322.25, 694.32, 627.93, 627.93],
                ['Month 3', 15, 5, 20, 2418.75, 1262.4, 1156.35, 1784.28],
                ['Month 4', 18, 7, 25, 2999.25, 1578, 1421.25, 3205.53],
                ['Month 5', 20, 5, 25, 3063.75, 1578, 1485.75, 4691.28],
                ['Month 6', 22, 3, 25, 3129.25, 1578, 1551.25, 6242.53],
                [''],
                ['TOTAL', 83, 23, 106, 12933.25, 6690.72, 6242.53, '']
            ];
            const ws4 = XLSX.utils.aoa_to_sheet(forecast);
            XLSX.utils.book_append_sheet(wb, ws4, '6-Month Forecast');

            // Sheet 5: VAT Scenarios
            const vat = [
                ['VAT IMPACT SCENARIOS'],
                [''],
                ['', 'Before VAT Registration', 'After VAT Registration'],
                ['Retail Price Shown', '¬£129.00', '¬£129.00'],
                ['Net Revenue (excl VAT)', '¬£129.00', '¬£107.50'],
                ['Unit Cost', '¬£63.12', '¬£63.12'],
                ['Profit per Unit', '¬£65.88', '¬£44.38'],
                [''],
                ['RECOMMENDATION: When VAT registered'],
                ['Option 1: Raise price to ¬£139-149'],
                ['Option 2: Absorb VAT (margin shrinks)'],
                ['Option 3: Start at ¬£129, raise to ¬£139 later']
            ];
            const ws5 = XLSX.utils.aoa_to_sheet(vat);
            XLSX.utils.book_append_sheet(wb, ws5, 'VAT Scenarios');

            // Sheet 6: Simple Ledger
            const ledger = [
                ['CASH LEDGER'],
                [''],
                ['Date', 'Description', 'Cash In', 'Cash Out', 'Balance'],
                ['YYYY-MM-DD', 'Example: Unit sold (DTC)', 129, '', 129],
                ['YYYY-MM-DD', 'Example: Parts order', '', 347, -218],
                ['', '', '', '', ''],
                ['', 'Add your transactions below:', '', '', '']
            ];
            const ws6 = XLSX.utils.aoa_to_sheet(ledger);
            XLSX.utils.book_append_sheet(wb, ws6, 'Cash Ledger');

            // Generate Excel file and download
            XLSX.writeFile(wb, 'Klang_Research_SSS1_Financial_Model.xlsx');
        }
    </script>
</body>
</html>
